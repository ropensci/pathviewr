<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating visual perceptions from tracking data • pathviewr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating visual perceptions from tracking data">
<meta property="og:description" content="pathviewr">
<meta property="og:image" content="https://docs.ropensci.org/pathviewr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pathviewr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-import-cleaning.html">Basics of data import and cleaning in pathviewr</a>
    </li>
    <li>
      <a href="../articles/managing-frame-gaps.html">Managing frame gaps with pathviewr</a>
    </li>
    <li>
      <a href="../articles/visual-perception-functions.html">Estimating visual perceptions from tracking data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/pathviewr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating visual perceptions from tracking
data</h1>
                        <h4 data-toc-skip class="author">Eric R.
Press</h4>
            
            <h4 data-toc-skip class="date">2022-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/pathviewr/blob/HEAD/vignettes/visual-perception-functions.Rmd" class="external-link"><code>vignettes/visual-perception-functions.Rmd</code></a></small>
      <div class="hidden name"><code>visual-perception-functions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Studies of visually guided locomotion in birds, insects or even
humans often involve data gathered from motion capture technologies such
as Optitrack’s <a href="https://optitrack.com/software/motive/" class="external-link">(Motive)</a>, or the Straw
Lab’s <a href="https://github.com/strawlab/flydra" class="external-link">(Flydra)</a>. For
these experiments, it is important to understand how visual stimuli
influence behavior. Although is it not possible to measure how subjects
directly perceive visual stimuli, it is possible to use motion capture
data to calculate estimates of stimulus properties as they are perceived
by the subject. With the tools available in pathviewr, researchers in
ethology or psychology may provide analyses of both stimulus and
response under natural locomotor conditions.</p>
<p><em>Inherent to estimations of visual perceptions, we make several
assumptions, which will be discussed below. We welcome suggestions and
aim to address any assumptions that limit the accuracy of these
estimates</em>.</p>
<p>To bridge the gap between objective measures of subject position and
estimates of subjective stimulus perception, we can begin by calculating
the angle that a visual pattern subtends on the subject’s retina: the
visual angle (θ). Visual angles can be used to calculate aspects of
image motion such as the rate of visual expansion <a href="https://www.pnas.org/doi/10.1073/pnas.1603221113/" class="external-link">(Dakin <em>et
al.</em>, 2016)</a>. For a detailed review of different forms of visual
motion and how they’re processed by the brain, see <a href="https://www.karger.com/Article/Abstract/314284" class="external-link">(Frost,
2010)</a>.</p>
<p>Visual angles can be calculated provided there is information about
the physical size of the pattern and its distance from the subject’s
retina. Because researchers can control or measure the size of a
pattern, and we can calculate the distance between the subject and
pattern using motion capture data, we can further calculate the visual
angle produced by patterns in the visual scene. Therefore, we first need
to calculate the distance from the subject’s retina to the pattern.</p>
<p><em>Currently, we assume the subject’s gaze is directly frontal or
lateral to the face, in effect estimating image properties at single
points in the frontal and lateral fields of view, respectively. We
currently calculate distances to the center of the subject’s head rather
than the position of the retina; future versions of
<code>pathviewr</code> will include features addressing these
limitations, such as including head orientation information and eye
position relative to the center of the subject’s head</em>.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/ropensci/pathviewr/dc728871873b92dc8412bdcb5ef58031457f6788/images/stim_param_angle.jpeg" alt="Visual angles can be calculated using the size of a visual pattern (`stim_param`) and the distance to the pattern. Larger patterns at shorter distances produce larger visual angles. For dot stimuli, visual angles can be calculated independent of stimulus orientation." width="100%"><p class="caption">
Visual angles can be calculated using the size of a visual pattern
(<code>stim_param</code>) and the distance to the pattern. Larger
patterns at shorter distances produce larger visual angles. For dot
stimuli, visual angles can be calculated independent of stimulus
orientation.
</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-packages">Loading packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h2>
<p>To begin, let’s load <code>pathviewr</code> and a few of the packages
in <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/pathviewr">pathviewr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>Data objects must be prepared as described in <a href="https://docs.ropensci.org/pathviewr/articles/data-import-cleaning.html">the
Data Import and Cleaning vignette</a> pipeline prior to their use with
these functions. For a detailed description of the importing and
cleaning functions, and when to use them, please see the linked
vignette.</p>
<p>Let’s work with a few example datasets included in the package.
<code>pathviewr_motive_example_data.csv</code> is a <code>.csv</code>
file exported from Motive.
<code>pathviewr_flydra_example_data.mat</code> is a <code>.mat</code>
file exported from Flydra. For more coarse-grained data cleaning tasks,
<code>pathviewr</code> contains an all-in-one cleaning function
<code>clean_viewr</code>. We will use this function for the following
examples.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import motive data set</span>
<span class="va">motive_data</span> <span class="op">&lt;-</span> <span class="co"># import</span>
  <span class="fu"><a href="../reference/read_motive_csv.html">read_motive_csv</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pathviewr_motive_example_data.csv"</span>,
                package <span class="op">=</span> <span class="st">'pathviewr'</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co">## Clean motive data set</span>
<span class="va">motive_full</span> <span class="op">&lt;-</span>
  <span class="va">motive_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/clean_viewr.html">clean_viewr</a></span><span class="op">(</span>
    relabel_viewr_axes <span class="op">=</span> <span class="cn">TRUE</span>,
    gather_tunnel_data <span class="op">=</span> <span class="cn">TRUE</span>,
    trim_tunnel_outliers <span class="op">=</span> <span class="cn">TRUE</span>,
    standardization_option <span class="op">=</span> <span class="st">"rotate_tunnel"</span>,
    select_x_percent <span class="op">=</span> <span class="cn">TRUE</span>,
    desired_percent <span class="op">=</span> <span class="fl">50</span>,
    rename_viewr_characters <span class="op">=</span> <span class="cn">FALSE</span>,
    separate_trajectories <span class="op">=</span> <span class="cn">TRUE</span>,
    max_frame_gap <span class="op">=</span> <span class="st">"autodetect"</span>,
    get_full_trajectories <span class="op">=</span> <span class="cn">TRUE</span>,
    span <span class="op">=</span> <span class="fl">0.95</span>
  <span class="op">)</span>
<span class="co">#&gt; autodetect is an experimental feature -- please report issues.</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import flydra data set</span>
<span class="va">flydra_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/read_flydra_mat.html">read_flydra_mat</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pathviewr_flydra_example_data.mat"</span>,
                package <span class="op">=</span> <span class="st">'pathviewr'</span><span class="op">)</span>,
    subject_name <span class="op">=</span> <span class="st">"birdie_wooster"</span><span class="op">)</span>

<span class="co">## Clean flydra data set</span>
<span class="va">flydra_full</span> <span class="op">&lt;-</span> 
  <span class="va">flydra_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/clean_viewr.html">clean_viewr</a></span><span class="op">(</span>
    relabel_viewr_axes <span class="op">=</span> <span class="cn">FALSE</span>,
    gather_tunnel_data <span class="op">=</span> <span class="cn">FALSE</span>,
    trim_tunnel_outliers <span class="op">=</span> <span class="cn">FALSE</span>,
    standardization_option <span class="op">=</span> <span class="st">"redefine_tunnel_center"</span>,
    length_method <span class="op">=</span> <span class="st">"middle"</span>,
    height_method <span class="op">=</span> <span class="st">"user-defined"</span>,
    height_zero <span class="op">=</span> <span class="fl">1.44</span>,
    get_velocity <span class="op">=</span> <span class="cn">FALSE</span>,
    select_x_percent <span class="op">=</span> <span class="cn">TRUE</span>,
    desired_percent <span class="op">=</span> <span class="fl">60</span>,
    rename_viewr_characters <span class="op">=</span> <span class="cn">FALSE</span>,
    separate_trajectories <span class="op">=</span> <span class="cn">TRUE</span>,
    get_full_trajectories <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-experiment-information-with-insert_treatments">Add experiment information with
<code>insert_treatments()</code><a class="anchor" aria-label="anchor" href="#add-experiment-information-with-insert_treatments"></a>
</h2>
<p>Now that our objects have been cleaned, we must use
<code><a href="../reference/insert_treatments.html">insert_treatments()</a></code> to add information about the
experiments, including relevant properties of the visual stimulus and
experimental tunnel that are necessary for calculating visual
perceptions.</p>
<p><em><code>pathviewr</code> currently supports rectangular (box) or
V-shaped experimental tunnels, though we are interested in including
additional tunnel configurations</em>.</p>
<p>If you would like to request any additional features such as other
tunnel configurations, please create an issue <a href="https://github.com/ropensci/pathviewr/issues/new/choose" class="external-link">(here)</a></p>
<div class="section level4">
<h4 id="v-shaped-tunnel-example">V-shaped tunnel example<a class="anchor" aria-label="anchor" href="#v-shaped-tunnel-example"></a>
</h4>
<p>The data within <code>motive_full</code> were collected from birds
flying through a 3m long V-shaped tunnel in which the height of the
origin <code>(0,0,0)</code> was set to the height of the perches that
were 0.3855m above the vertex, which was angled at 90 degree. The visual
stimuli on the positive and negative walls of the tunnel (where
<code>position_width</code> values &gt; 0 and &lt; 0, respectively) were
stationary dot-fields. Each dot was of size 0.05m in diameter. The
visual stimuli on the positive and negative end walls of the tunnel
(where <code>position_length</code> &gt; 0 and &lt; 0, respectively)
were dot fields with dots 0.1m in diameter. This treatment was referred
to as <code>"latB"</code>.</p>
<p>Therefore we will use the following code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motive_treatments</span> <span class="op">&lt;-</span> 
  <span class="va">motive_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/insert_treatments.html">insert_treatments</a></span><span class="op">(</span>tunnel_config <span class="op">=</span> <span class="st">"v"</span>,
                    perch_2_vertex <span class="op">=</span> <span class="fl">0.3855</span>,
                    vertex_angle <span class="op">=</span> <span class="fl">90</span>,
                    tunnel_length <span class="op">=</span> <span class="fl">2</span>,
                    stim_param_lat_pos <span class="op">=</span> <span class="fl">0.05</span>,
                    stim_param_lat_neg <span class="op">=</span> <span class="fl">0.05</span>,
                    stim_param_end_pos <span class="op">=</span> <span class="fl">0.1</span>,
                    stim_param_end_neg <span class="op">=</span> <span class="fl">0.1</span>,
                    treatment <span class="op">=</span> <span class="st">"latB"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">motive_treatments</span><span class="op">)</span>
<span class="co">#&gt;  [1] "tunnel_config"      "perch_2_vertex"     "vertex_angle"      </span>
<span class="co">#&gt;  [4] "tunnel_length"      "stim_param_lat_pos" "stim_param_lat_neg"</span>
<span class="co">#&gt;  [7] "stim_param_end_pos" "stim_param_end_neg" "treatment"         </span>
<span class="co">#&gt; [10] "frame"              "time_sec"           "subject"           </span>
<span class="co">#&gt; [13] "position_length"    "position_width"     "position_height"   </span>
<span class="co">#&gt; [16] "rotation_length"    "rotation_width"     "rotation_height"   </span>
<span class="co">#&gt; [19] "rotation_real"      "mean_marker_error"  "velocity"          </span>
<span class="co">#&gt; [22] "length_inst_vel"    "width_inst_vel"     "height_inst_vel"   </span>
<span class="co">#&gt; [25] "traj_id"            "file_sub_traj"      "traj_length"       </span>
<span class="co">#&gt; [28] "start_length"       "end_length"         "length_diff"       </span>
<span class="co">#&gt; [31] "start_length_sign"  "end_length_sign"    "direction"</span></code></pre></div>
<p><code>motive_treatments</code> now has the variables
<code>tunnel_config</code>, <code>perch_2_vertex</code>,
<code>vertex_angle</code>, <code>tunnel_length</code>,
<code>stim_param_lat_pos</code>, <code>stim_param_lat_neg</code>,
<code>stim_param_end_pos</code>, and <code>stim_param_end_neg</code>
which are needed to calculate visual angles. The variable
<code>treatment</code> has also been included and all of this
information has been stored in the object’s metadata.</p>
</div>
<div class="section level4">
<h4 id="box-shaped-tunnel-example">Box-shaped tunnel example<a class="anchor" aria-label="anchor" href="#box-shaped-tunnel-example"></a>
</h4>
<p>The data within <code>flydra_full</code> were collected from birds
flying in a 1 x 3m rectangular tunnel (a box). The visual stimuli were
the same as in the motive example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flydra_treatments</span> <span class="op">&lt;-</span>
  <span class="va">flydra_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/insert_treatments.html">insert_treatments</a></span><span class="op">(</span>tunnel_config <span class="op">=</span> <span class="st">"box"</span>,
                    tunnel_width <span class="op">=</span> <span class="fl">1</span>,
                    tunnel_length <span class="op">=</span> <span class="fl">3</span>,
                    stim_param_lat_pos <span class="op">=</span> <span class="fl">0.05</span>,
                    stim_param_lat_neg <span class="op">=</span> <span class="fl">0.05</span>,
                    stim_param_end_pos <span class="op">=</span> <span class="fl">0.1</span>,
                    stim_param_end_neg <span class="op">=</span> <span class="fl">0.1</span>,
                    treatment <span class="op">=</span> <span class="st">"latB"</span><span class="op">)</span></code></pre></div>
<p><code>flydra_treatments</code> similarly has the variables
<code>tunnel_config</code>, <code>tunnel_width</code>,
<code>tunnel_length</code>, <code>stim_param_lat_pos</code>,
<code>stim_param_lat_neg</code>, <code>stim_param_end_pos</code>,
<code>stim_param_end_neg</code> and <code>treatment</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-visual-angles">Calculating visual angles<a class="anchor" aria-label="anchor" href="#calculating-visual-angles"></a>
</h2>
<div class="section level3">
<h3 id="start-by-calculating-distances-to-visual-stimuli">Start by calculating distances to visual stimuli<a class="anchor" aria-label="anchor" href="#start-by-calculating-distances-to-visual-stimuli"></a>
</h3>
<p>To estimate the visual angles perceived by the subject is it moves
through the tunnel, we first need to calculate the distance between the
subject and the visual stimuli. For this, we will use
<code>calc_min_dist_v</code> or <code>calc_min_dist_box</code> depending
on the configuration of the experimental tunnel. These functions
calculate the minimum distance between the subject and the surface
displaying a visual pattern, therefore maximizing the visual angles.</p>
<p>For V-shaped tunnels, several internal calculations are required and
can be added to the output object with
<code>simplify_output = FALSE</code>. Otherwise, the minimum distance
are computed to the lateral walls and the end wall to which the subject
is facing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motive_min_dist</span> <span class="op">&lt;-</span> 
  <span class="va">motive_treatments</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/calc_min_dist_v.html">calc_min_dist_v</a></span><span class="op">(</span>simplify_output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co">## Display minimum distances to the positive lateral walls </span>
<span class="co">## Viewpoint is from the end of the tunnel</span>
<span class="va">motive_min_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_width</span>, y <span class="op">=</span> <span class="va">position_height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">min_dist_pos</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/motive_min_dist_pos-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flydra_min_dist</span> <span class="op">&lt;-</span> 
  <span class="va">flydra_treatments</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/calc_min_dist_box.html">calc_min_dist_box</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## Display minimum distances to the end walls</span>
<span class="co">## Viewpoint is from above the tunnel</span>
<span class="va">flydra_min_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_length</span>, y <span class="op">=</span> <span class="va">position_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">min_dist_end</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,         <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,         <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/flydra_min_dist_end-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="now-get-visual-angles">Now get visual angles<a class="anchor" aria-label="anchor" href="#now-get-visual-angles"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motive_vis_angle</span> <span class="op">&lt;-</span> 
  <span class="va">motive_min_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/get_vis_angle.html">get_vis_angle</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## Visualize the angles produced from stimuli on the positive wall</span>
<span class="co">## Viewpoint is from the end of the tunnel</span>
<span class="va">motive_vis_angle</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_width</span>, y <span class="op">=</span> <span class="va">position_height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">vis_angle_pos_deg</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/motive_vis_angle_pos-1.png" width="672"></p>
<p>Notice larger visual angles as the subject approaches the positive
wall.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flydra_vis_angle</span> <span class="op">&lt;-</span> 
  <span class="va">flydra_min_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/get_vis_angle.html">get_vis_angle</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## Visualize the angles produced by stimuli on the end walls</span>
<span class="co">## Viewpoint is from above the tunnel</span>
<span class="va">flydra_vis_angle</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_length</span>, y <span class="op">=</span> <span class="va">position_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">vis_angle_end_deg</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,        <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,        <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/flydra_vis_angle_end-1.png" width="672"></p>
<p>Notice larger visual angles as the subject approaches the end wall
that it is moving towards.</p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-spatial-frequency">Calculating spatial frequency<a class="anchor" aria-label="anchor" href="#calculating-spatial-frequency"></a>
</h2>
<p>With visual angles, we can now determine the spatial frequency of a
visual pattern as it is perceived by the subject. Spatial frequency
refers to the size of the pattern in visual space. It’s often reported
as the number of cycles of a visual pattern per 1 degree of the visual
field (cycles/degree). Here, we will define a cycle length as the length
used for the <code>stim_param</code>. For a given distance from the
subject, a larger visual pattern produces a smaller spatial frequency,
whereas a smaller visual pattern produces a larger spatial
frequency.</p>
<p>To calculate the spatial frequency of the visual stimuli as perceived
by the subject some distance from the stimuli, we will use
<code><a href="../reference/get_sf.html">get_sf()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motive_sf</span> <span class="op">&lt;-</span> 
  <span class="va">motive_vis_angle</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/get_sf.html">get_sf</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## Visualize the spatial frequency of the stimulus on the positive wall </span>
<span class="co">## point is from the end of the tunnel</span>
<span class="va">motive_sf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_width</span>, y <span class="op">=</span> <span class="va">position_height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">sf_pos</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,         <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3855</span>,
                   xend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5869</span>,
                   yend <span class="op">=</span> <span class="fl">0.2014</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/motive_sf_pos-1.png" width="672"></p>
<p>Notice the spatial frequency increases the further the subject
recedes from positive wall.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flydra_sf</span> <span class="op">&lt;-</span> 
  <span class="va">flydra_vis_angle</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/get_sf.html">get_sf</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## Visualize the spatial frequency of the stimulus on the end walls</span>
<span class="co">## Viewpoint is from above the tunnel</span>
<span class="va">flydra_sf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">position_length</span>, y <span class="op">=</span> <span class="va">position_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">sf_end</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,        <span class="co"># negative wall</span>
                   y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,        <span class="co"># positive wall</span>
                   y <span class="op">=</span> <span class="fl">0.5</span>,
                   xend <span class="op">=</span> <span class="fl">1</span>,
                   yend <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="visual-perception-functions_files/figure-html/flydra_sf_end-1.png" width="672"></p>
<p>Notice the spatial frequency decreases as the subject approaches the
end wall that it is moving towards.</p>
<div class="section level3">
<h3 id="stay-tuned-as-additional-features-for-image-motion-estimation-are-coming-soon">Stay tuned as additional features for image motion estimation are
coming soon!<a class="anchor" aria-label="anchor" href="#stay-tuned-as-additional-features-for-image-motion-estimation-are-coming-soon"></a>
</h3>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.vikram-baliga.com/" class="external-link">Vikram B. Baliga</a>, <a href="https://melissasarmstrong.com" class="external-link">Melissa S. Armstrong</a>, <a href="https://www.grad.ubc.ca/campus-community/meet-our-students/press-eric" class="external-link">Eric R. Press</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
